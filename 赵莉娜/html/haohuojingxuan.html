<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<title>省钱约</title>
		<link rel="shortcut icon" type="image/ico" href="../img/ico.jpg">
		<link rel="stylesheet" type="text/css" href="../bootstrap/css/bootstrap.min.css" />
		<link rel="stylesheet" type="text/css" href="../css/haohuojingxuan.css" />
	</head>

	<body>
		<!--网页顶部-->
		<div class="top">
			<a href="index.html">
				<div class="logo">
					<b class="logo_txt1">省钱约</b>
					<p class="logo_txt2">省钱神器 领劵专用</p>
				</div>
			</a>
			<input type="search" name="搜索" id="search" class="search" placeholder="搜索你想要的..." />
			<input type="button" name="搜索按钮" class="search_btn" value="搜索" />
			<div class="top_r"></div>
		</div>
		<!--网页导航-->
		<nav>
			<div class="container" style="width: 1200px;padding: 0;">
				<ul class="navbar-nav">
					<li class="daohang">
						<a href="../index.html">网站首页</a>
					</li>
					<li class="daohang">
						<a href="haohuojingxuan.html">好货精选</a>
					</li>
					<li class="daohang">
						<a href="baokuanfengqiang.html">爆款疯抢</a>
					</li>
					<li class="daohang">
						<a href="baoyou.html">9.9包邮</a>
					</li>
					<li class="daohang">
						<a href="dongdongqiang.html">咚咚抢</a>
					</li>
					<!--<li class="daohang">
						<a href="html/app.html">省钱约APP</a>
					</li>-->
				</ul>
			</div>
		</nav>
		<!--小导航-->
		<div class="container xdh" style="width: 1200px;overflow: hidden;margin-top: 16px;">
			<p>
				<a href="haohuojingxuan.html">全部商品</a>
				<span class="shangpin_text1">>></span>
				<span class="shangpin_text1">共</span>
				<span class="shangpin_text2" style="color: red;">10000+</span>
				<span class="shangpin_text1">款相关商品</span>
			</p>
			<dl class="cation-list" style="width: 1177px; background-color: white;margin-left: -3px;">
				<p class="small_sousuo" style="width: 1200px;height: 40px;margin: 14px auto;display: none;">
					<input style="width: 430px; margin: 0;" type="search" id="search1" name="搜索" class="search search1" placeholder="搜索你想要的..." />
					<input style="margin-top: 0;" type="button" name="搜索按钮" class="search_btn search_btn1" value="搜索" />
				</p>

				<dt>分类</dt>
				<dd>
					<a href="#" rel="" name="mode" class="all on">全部</a>
					<a href="#" rel="食品保健" name="mode" class="default">食品保健</a>
					<a href="#" rel="数码家电" name="mode" class="default">数码家电</a>
					<a href="#" rel="文娱车品" name="mode" class="default">古玩古董</a>
					<a href="#" rel="家装家纺" name="mode" class="default">家装家纺</a>
					<a href="#" rel="居家日用" name="mode" class="default">居家日用</a>
					<a href="#" rel="户外运动" name="mode" class="default">户外运动</a>
					<a href="#" rel="美容护肤" name="mode" class="default">美容护肤</a>
					<a href="#" rel="珠宝饰品" name="mode" class="default">珠宝饰品</a>
					<a href="#" rel="鲜花礼品" name="mode" class="default">鲜花礼品</a>
					<a href="#" rel="童装母婴" name="mode" class="default">童装母婴</a>
				</dd>
			</dl>


		</div>
		<!--内容部分-->
		<div class="container" id="content_box" style="width:100%;padding: 0;">
			<div class="content">
			</div>
			<!--分页-->
			<div id="page" style="margin-bottom: 40px;"></div>
		</div>
		<!--底部-->
		<div class="container footer_box" style="width: 100%;height: 160px;background-color:rgba(0,0,0,.8);">
			<div class="footer">
				<p class="footer_text1 " style="margin-top: 30px; ">网站导航：
					<a href="../index.html "><span>网站首页</span></a>
					<a href="haohuojingxuan.html "><span>好货精选</span></a>
					<a href="baokuanfengqiang.html"><span>爆款疯抢</span></a>
					<a href="baoyou.html "><span>9块9包邮</span></a>
					<a href="dongdongqiang.html "><span>咚咚抢</span></a>
				</p>
				<p class="footer_text1">省钱约是一家中立的导购网站，网站中的商品信息均来自于互联网。如商品信息不同，可能是商品信息未及时更新，所有商品信息请以天猫/淘宝店铺内为准。</p>
				<p class="footer_text1">Copyright©2019　省钱约：淘宝天猫（天猫超市）优惠券、代金券、抵用券、购物券、打折券领取 晋ICP备17016163号-4　 </p>
			
			</div>
		</div>
		<!--回到顶部-->
		<div class="back_top"></div>
	</body>
	<script src="../js/jquery-3.4.1.min.js" type="text/javascript" charset="utf-8"></script>
	<script src="../bootstrap/js/bootstrap.min.js" type="text/javascript" charset="utf-8"></script>
	<script type="text/javascript" src="../js/xlPaging.js"></script>
	<script src="../js/current.js" type="text/javascript" charset="utf-8"></script>
	<script src="../js/jquery.lazyload.js" type="text/javascript" charset="utf-8"></script>
	<script type="text/javascript">
		//		商品分类
		$.ajax({
			type: "get",
			url: "http://localhost/w/website/findGoodsTypeList",
			async: true,
			success: function(res) {
				console.log(res)
				var data = res.data;

				var str2 = '';
				for(var i = 0; i < data.length; i++) {
					str2 += `
						<div class="left_box">
							<img src="${data[i].icon}" />
							<p class="left_text">${data[i].name}</p>
						</div>
					`;

				}
				$(".lb_left").html(str2);
			}
		});
		//		商品分类查询
		function chaxun(info, page) {
			$.ajax({
				type: "get",
				url: "http://127.0.0.1/w/website/findGoodsList",
				data: {
					"platId": "d0a500ecf8ab41aa9ffe8e18ac6419e1",
					"info": info,
					"pageNo": page
				},
				success: function(res) {
					var data = res.data.tbk_dg_material_optional_response.result_list.map_data;
					console.log(data);
					str3 = ""
					for(var i = 0; i < data.length; i++) {
						if(data[i].coupon_amount == undefined) {
							data[i].coupon_amount = 0;
							data[i].coupon_share_url = "";
						}
						str3 += `
								<div class="content_item">
									<div class="content_left">
										<a class="item_text" href="${data[i].item_url}">
											<img class="lazy" data-original="${data[i].pict_url}"/>
										</a>
									</div>
									<div class="content_right">
										<p class="shop_title">${data[i].shop_title}</p>
										<a class="item_text" href="${data[i].item_url}">
											<p class="title">${data[i].short_title}</p>
										</a>
										<p class="qhj">
											<span class="qhj_txt2">¥</span>
											<span class="qhj_txt3">${data[i].zk_final_price}</span>
											<span class="xsl_text1">¥${data[i].reserve_price}</span>
											<span class="xsl_text2">已售出${data[i].tk_total_sales}件</span>
										</p>
										<div class="youhui">
											<span class="youhui_text1">${data[i].coupon_amount}元优惠券</span>
											<span class="youhui_text2">
												<a href="${data[i].coupon_share_url}">立即领取>></a>
											</span>
										</div>
									</div>
									
								</div>
							`;
					}
					$(".content").html(str3);
					$("img.lazy").lazyload({
						effect: "fadeIn"
					});
					$("img.lazy").lazyload({
						threshold: 180
					});
				}
			});

			document.body.scrollTop = document.documentElement.scrollTop = 0;
		}
		//		点击查询
		chaxun("好货", 1);
		$(".lb_left").on("click", ".left_box", function() {
			var i = $(this).index();
			//			console.log(i);
			var x = $(".left_text").eq(i).text();
			chaxun(x, 1);
			tiaozhuan(x);
		});
		//		搜索
		function sousuo() {
			var x = $(".search")[0].value;
			//			console.log(x);
			chaxun(x, 1);
			tiaozhuan(x);
		}
		$(".search_btn").click(function() {
			sousuo();
		})

		function sousuo1() {
			var x = $(".search1")[0].value;
			//			console.log(x);
			chaxun(x, 1);
			tiaozhuan(x);
		}
		$(".search_btn1").click(function() {
			sousuo1();
		})

		document.onkeydown = function(e) {
			var ev = (typeof event != 'undefined') ? window.event : e;
			if(ev.keyCode == 13 && document.activeElement.id == "search") { //activeElement活动事件,该事件只可以使用于输入域中
				sousuo();
				
			} else if(ev.keyCode == 13 && document.activeElement.id == 'search1') {
				sousuo1();
			}
		};

		//		分页
		function tiaozhuan(fenlei) {
			$("#page").paging({
				nowPage: 1, // 当前页码
				pageNum: 50, // 总页码
				buttonNum: 6, //要展示的页码数量
				canJump: 1, // 是否能跳转。0=不显示（默认），1=显示
				showOne: 0, //只有一页时，是否显示。0=不显示,1=显示（默认）
				callback: function(num) { //回调函数
					console.log(num);
					chaxun(fenlei, num);
				}
			});
		}
		tiaozhuan("好货")
		//		回到顶部

		var backtop = document.getElementsByClassName("back_top")[0];
		var scrolltop;
		window.onscroll = function() {
			scrolltop = document.body.scrollTop || document.documentElement.scrollTop;
			if(scrolltop > 200) {
				backtop.style.display = "block";
			} else {
				backtop.style.display = "none";
			}
		}

		backtop.onclick = function() {
			document.body.scrollTop = document.documentElement.scrollTop = 0;
		}
		//		小导航点击事件
		$(".default").click(function() {
			var x = $(this).index();
			var text = $(".default").eq(x - 1).text();
			//			console.log(text);
			chaxun(text, 1);
			tiaozhuan(text);
			$(".default").eq(x - 1).css("color", "#fc8080").siblings().css("color", "#8d8d91")
		})
		$(window).on("scroll", function() {
			//判断向下滑动的距离
			if($(window).scrollTop() >= 100) {
				//将顶部导航栏固定
				$(".cation-list").addClass("fixed");
				$(".small_sousuo").show();
			} else {
				$(".cation-list").removeClass("fixed");
				$(".small_sousuo").hide();
			}
		});
	</script>

</html>